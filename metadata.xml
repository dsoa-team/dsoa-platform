<ipojo xmlns:wbp="org.apache.felix.ipojo.whiteboard">

	<!-- DSOA Handlers -->
	<handler classname="br.ufpe.cin.dsoa.handler.provider.ProviderManager"
		name="provider-manager" namespace="br.ufpe.cin.dsoa">
	</handler>

	<handler classname="br.ufpe.cin.dsoa.handler.dependency.DependencyHandler"
		name="requires" namespace="br.ufpe.cin.dsoa">
	</handler>

	<!-- DSOA Components -->
	
	
	<component classname="br.ufpe.cin.dsoa.handler.dependency.manager.EsperVerifier">
		<requires field="metricComputingService"  /> 
		<provides/>
	</component>
	
	<component classname="br.ufpe.cin.dsoa.configurator.PlatformConfigurator">
		<requires field="metricComputingService" />
		<requires field="eventProcessingService" />
		<callback transition="validate" method="start" />
		<callback transition="invalidate" method="stop" />
	</component>
	
<!-- 	<component classname="br.ufpe.cin.dsoa.monitor.impl.MonitoringDepencencyImpl">
		<requires field="eventProcessingService" />
		<provides />
	</component> -->
	
	<component classname="br.ufpe.cin.dsoa.attribute.impl.AttributeCatalogImpl">
		<requires field="eventProcessingService" />
		<provides />
	</component>
		
	<component classname="br.ufpe.cin.dsoa.event.impl.EventProcessingServiceImpl" >
		<provides />
		<callback transition="validate" method="start" />
		<callback transition="invalidate" method="stop" />
	</component>
	
	<component classname="br.ufpe.cin.dsoa.broker.impl.BrokerImpl">
		<provides />
	</component>	
		
	<!-- ============================================================================================================ -->		
	<!-- ============================================================================================================ -->
	<!-- ========================== 			DSOA MONITORING COMPONENTS				   ========================== -->
	<!-- ============================================================================================================ -->
	<!-- ============================================================================================================ -->
	<!--  -->
	<component classname="br.ufpe.cin.dsoa.monitor.impl.MonitoringServiceImpl">
		<requires field="eventProcessingService" />
		<provides />
	</component>
	
	<component classname="br.ufpe.cin.dsoa.monitor.impl.MonitoredServiceListenerImpl">
		<requires field="monitoringService" />
		<provides />
		<wbp:wbp 
   	      filter="(monitored.service=*)" 
          onArrival="onArrival" 
          onDeparture="onDeparture" 
         />
	</component>
		
	<!-- ============================================================================================================ -->		
	<!-- ============================================================================================================ -->
	<!-- ========================== 			DSOA MANAGEMENT COMPONENTS				   ========================== -->
	<!-- ============================================================================================================ -->
	<!-- ============================================================================================================ -->
	<!-- 
		The ManagementService component is the DSOA's management Facade. It is responsible for providing an access point
		to perform management related activities. It is exposed as remote service in order to allow remote management. The
		other components are shell commands intended to allow local administration. 
	-->
	<component classname="br.ufpe.cin.dsoa.management.impl.ManagementServiceImpl">
		<requires field="metricComputingService" />
		<requires field="monitoringService" />
		<provides >
			<property name="org.apache.cxf.ws.address"   value="http://localhost:9090/ManagementService"  	type="java.lang.String"/>
			<property name="service.exported.interfaces"  value="*"  type="java.lang.String"/>
			<property name="service.exported.configs"  value="org.apache.cxf.ws"  type="java.lang.String"/>
		</provides>
	</component>
		
	<component classname="br.ufpe.cin.dsoa.management.shell.DsoaCommand">
		<provides />
	</component>
	
	<component classname="br.ufpe.cin.dsoa.management.shell.MetricListCommand">
		<requires field="managementService"/>
		<provides />
	</component>
	
	<component classname="br.ufpe.cin.dsoa.management.shell.ServiceListCommand">
		<requires field="managementService"/>
		<provides />
	</component>
	
	<component classname="br.ufpe.cin.dsoa.management.shell.ServiceOperationsCommand">
		<requires field="managementService"/>
		<provides />
	</component>
	
	<component classname="br.ufpe.cin.dsoa.management.shell.MonitorCommand">
		<requires field="managementService"/>
		<provides />
	</component>
	
	<!-- ============================================================================================================ -->		
	<!-- ============================================================================================================ -->
	<!-- ========================== 			DSOA COMPONENT INSTANCES				   ========================== -->
	<!-- ============================================================================================================ -->
	<!-- ============================================================================================================ -->
	<!-- Dsoa Main components -->
	<instance component="br.ufpe.cin.dsoa.configurator.PlatformConfigurator" />
	<instance component="br.ufpe.cin.dsoa.management.impl.ManagementServiceImpl" />
	<instance component="br.ufpe.cin.dsoa.event.impl.EventProcessingServiceImpl" />
	<instance component="br.ufpe.cin.dsoa.monitor.impl.MonitoringServiceImpl" />
	<instance component="br.ufpe.cin.dsoa.attribute.impl.AttributeCatalogImpl" />
	<instance component="br.ufpe.cin.dsoa.broker.impl.BrokerImpl"/>
	<instance component="br.ufpe.cin.dsoa.handler.dependency.manager.EsperVerifier"/>
	<instance component="br.ufpe.cin.dsoa.monitor.impl.MonitoredServiceListenerImpl"/>
	<!-- <instance component="br.ufpe.cin.dsoa.configurator.hook.DsoaFindHook" />  -->
	
	<!-- Dsoa commands -->
	<instance component="br.ufpe.cin.dsoa.management.shell.DsoaCommand" />
	<instance component="br.ufpe.cin.dsoa.management.shell.MetricListCommand" />
	<instance component="br.ufpe.cin.dsoa.management.shell.ServiceListCommand" />
	<instance component="br.ufpe.cin.dsoa.management.shell.ServiceOperationsCommand" />
	<instance component="br.ufpe.cin.dsoa.management.shell.MonitorCommand" />

</ipojo>